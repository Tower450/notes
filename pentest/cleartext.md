# cleartext

## auditd

### pam_tty_audit

> PAM (Pluggable Authentication Modules) module can be used to enable auditing of TTY input for specified users.

    # setup: add above the first `session required`
    /etc/pam.d/common-session   # debian/ubuntu
    /etc/pam.d/system-auth      # redhat/fedora
    /etc/pam.d/password-auth    # redhat/fedora
    UsePAM yes                  # extend to sshd
    # one of these lines (log_passwd issupported in kernel 3.9+)
    session required pam_tty_audit.so disable=user1,user2 enable=user3,user4
    session required pam_tty_audit.so enable=* log_passwd

    # view the audit log (pulled from audit.log)
    $ aureport --tty
    18. 05/23/2019 20:00:00 108 1000 ? 5 sudo "Password1"

    # view directely from log file
    $ grep -rni 'comm="su"' /var/log/audit
    audit.log.3:32:type=TTY msg=audit(1597199293.906:84): tty pid=2520 uid=1002 auid=0 ses=1 major=4 minor=1 comm="su" data=50617373776f726431
    $ echo 50617373776f726431 | xxd -r -p
    Password1
