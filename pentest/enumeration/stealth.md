# stealth

## arp

> The address resolution protocol (arp) is a protocol used by the Internet Protocol (IP) [RFC826], specifically IPv4, to map IP network addresses to the hardware addresses used by a data link protocol. The protocol operates below the network layer as a part of the interface between the OSI network and OSI link layer.

    netdiscover -i eth0
    arp-scan -I eth0 <ip>/24    # noisy

## ping

    hping3 code.google.com -S -p 80 -c 3
    hping3 <ip> -S -c 3

## nmap

    nmap -e eth0 <ip>
    nmap -S <source-ip> <target-ip>
    nmap --spoof-mac Cisco <ip>
    nmap --spoof-mac 0 <ip>          # random mac

    # flood IDS with misleading data with decoys (fake ips)
    nmap -D RND:10 <target-ip>  # 10 random decoys
    nmap -D <decoy-ip1>,<decoy-ip2> <target-ip>

https://nmap.org/book/man-bypass-firewalls-ids.html

## msfconsole

### change useragent

    use auxiliary/fuzzers/http/http_from_field
    auxiliary(http_form_field) > set UserAgent
    set UserAgent Googlebot/1.9 (+http://www.google.com/bot.html)

https://developer.chrome.com/multidevice/user-agent

## disable ipv6

    # check current
    $ sudo sysctl -a | grep net.ipv6.conf.lo.disable
    net.ipv6.conf.lo.disable_ipv6 = 0
    net.ipv6.conf.lo.disable_policy = 0

    # /etc/sysctl.conf
    net.ipv6.conf.all.disable_ipv6 = 1
    net.ipv6.conf.default.disable_ipv6 = 1
    net.ipv6.conf.lo.disable = 1

    # load them from config files
    sysctl --system --pattern '^net.ipv6'

    # or apply one by one
    sysctl -w net.ipv6.conf.all.disable_ipv6=1
    sysctl -w net.ipv6.conf.default.disable_ipv6=1
    sysctl -w net.ipv6.conf.lo.disable=1
