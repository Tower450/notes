# active

## port 21: ftp

    $ nmap -p 21 --script ftp* <ip>
    Attempt Anon login:
    User: Anonymous
    Pass: Anonymous

## port 22: ssh

    nmap -p 22 --script ssh* -oA ssh_scan <ip>

    ssh-keyscan <ip>
    ssh-vulnkey <ip> key.pub

https://github.com/mgit-at/ssh-vulnkey

## port 25/587: smtp

    nmap --open --script smtp-enum-users -sS -p 25 -sV $IP/24

## port 79: finger

    finger root@<ip>
    finger admin@<ip>
    finger 'a b c d e f g h'@<ip>

## port 80: http

    nikto http://192.168.56.1 -o nikto.txt
    dirb http://192.168.56.1 -r -o dirb.txt
    gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 100 -e -u http://192.168.56.1/

### wpsscan

    wpscan --update
    # enum plugins
    wpscan --url <http://> --enumerate p
    # enum themes
    wpscan --url <http://> --enumerate t
    # enum users
    wpscan --url <http://> --enumerate u
    # bruteforce users
    wpscan --url <http://> --wordlist <pass.txt> --threads 50
    # bruteforce admin
    wpscan --url <http://> --wordlist <pass.txt> --username admin --threads 50

## port 111: rpcbind

    # rid cycling: enum users
    rpcclient -U "" TARGET

## port 161: snmp

    # find hosts
    nmap -sU --open -p 161 192.168.1.0/24 -oG SNMP_hosts.txt

    # simple enumeration:
    nmap -p 161 --script snmp-enum <ip>
    snmp-check <ip>

    # community enumeration:
    onesixtyone -c community.txt -i <ip>

    # after knowing the comminuty string:
    snmpwalk -c <community_string> -v1 <ip>

    # enum users
    snmpwalk -c public -v1 <ip> 1.3.6.1.4.1.77.1.2.25

    # enum open tcp ports
    snmpwalk -c public -v1 <ip> 1.3.6.1.2.1.6.13.1.3

    # enum patches (windows)
    snmpwalk -c public -v1 <ip> 1.3.6.1.2.1.25.6.3.1.2

## port 389: ldap

    ldapsearch -h <ip> -p <port> -x -s base

    # -x: simple Authentication, -s: scope (base, one, sub)
    ldapsearch -LLL -x -H ldap://<FQDN> -b '' -s base '(objectclass=*)'

## port 443: https

same as port 80 http plus:

    sslscan <ip>
    nmap -sV --script ssl-enum-ciphers -p 443 <ip>

## port 139/445: smb

    # find hosts
    nmap -v -p 139, 445 -oA SMB_Scan 10.11.1.0/24

    nmblookup -A <ip>
    nbtscan <ip>
    nbtscan -r 192.168.1.1/24

    smbclient -L //<IP>
    smbclient //MOUNT/share -I TARGET -N
    smbclient //<IP>/sharename -U <username>

    rpcclient -U "" TARGET

    enum4linux -a TARGET

    nmap -p 139, 445 --script smb* -oA smb_scan <ip>

    crackmapexec smb -u users.txt -p passes.txt --local-auth 10.10.10.178 --continue-on-success

https://www.blackhillsinfosec.com/password-spraying-other-fun-with-rpcclient/

## port 514: syslog

## port 1433/4: ms-sql

## port 2049: nfs

    apt-get install nfs-common

    showmount -e <ip>

    mkdir /tmp/nfs
    mount -t nfs <ip>:<share> /tmp/nfs

When mounting the shares often times the User id (uid) will be checked as an "authentificated" to the share to make sure that only the user that owns the share can access the content, even though you have successfully mounted it on your local machine. As such, if you know the uid of the user in question you can create a user with the same userid witht he following command:

    # add a user with a uid of 2000
    useradd -u 2000 lokii

## port 3128: squid proxy

## port 3306: mysql

    mysql -u admin -padmin -h <ip>
    mysql -u admin -padmin -c "show databases;set database mysql;select* from users;"
